import{j as e}from"./radix-ui-C6G5B-jo.js";import{f as w,u as v,r as n,L as h}from"./react-vendor-Dt2nJDur.js";import{C as k,a as C,b as O,c as L,d as E,f as T,g as u,h as a,i as P,B as g,e as S,s as o}from"./index-dxZvUXjE.js";import{G as I,a as G,L as R,t}from"./ui-vendor-DauYOwWM.js";function F({email:c,onVerify:b}){const f=w(),j=v(),[i,x]=n.useState(!1),[d,N]=n.useState(""),[r,m]=n.useState(c||j.state?.email);n.useEffect(()=>{c&&m(c)},[c]),n.useEffect(()=>{r||(async()=>{const{data:{user:l}}=await o.auth.getUser();l?.email&&m(l.email)})()},[r]);const p=async()=>{if(!r){t.error("البريد الإلكتروني غير موجود. الرجاء تسجيل الدخول مرة أخرى.");return}try{const{error:s}=await o.auth.resend({type:"signup",email:r});if(s)throw s;t.success("تم إعادة إرسال رمز التحقق بنجاح")}catch(s){console.error("Resend Error:",s),t.error(s.message||"فشل إرسال الرمز")}},y=async()=>{if(d.length<6){t.error("الرجاء إدخال رمز التحقق كاملاً");return}x(!0);try{const{data:s,error:l}=await o.auth.verifyOtp({email:r,token:d,type:"signup"});if(l)throw l;b(),t.success("تم تفعيل حسابك بنجاح!"),f("/dashboard")}catch(s){console.error("OTP Error:",s),t.error("رمز التحقق غير صحيح أو منتهي الصلاحية")}finally{x(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-black to-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs(h,{to:"/",className:"inline-flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"bg-orange-500 p-3 rounded-lg",children:e.jsx(I,{className:"h-8 w-8 text-black"})}),e.jsx("span",{className:"text-white text-2xl",children:"منصة التعليم"})]})}),e.jsxs(k,{className:"border-orange-500/20",children:[e.jsxs(C,{className:"space-y-1",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-orange-500/10 p-4 rounded-full",children:e.jsx(G,{className:"h-12 w-12 text-orange-500"})})}),e.jsx(O,{className:"text-2xl text-center",children:"التحقق من البريد الإلكتروني"}),e.jsxs(L,{className:"text-center",children:["أدخل رمز التحقق المرسل إلى ",r||"بريدك الإلكتروني"]})]}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",dir:"ltr",children:[e.jsx("span",{className:"text-sm text-gray-500 mb-2 font-medium",children:"الرمز المكون من 8 أرقام"}),e.jsxs(T,{maxLength:8,value:d,onChange:s=>N(s),children:[e.jsxs(u,{children:[e.jsx(a,{index:0,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:1,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:2,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:3,className:"w-10 h-10 text-lg border border-black rounded-md"})]}),e.jsx(P,{}),e.jsxs(u,{children:[e.jsx(a,{index:4,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:5,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:6,className:"w-10 h-10 text-lg border border-black rounded-md mr-1"}),e.jsx(a,{index:7,className:"w-10 h-10 text-lg border border-black rounded-md"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{onClick:y,className:"w-full bg-orange-500 hover:bg-orange-600 text-black",disabled:i||d.length<6,children:[i?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):null,"تفعيل الحساب"]}),e.jsx(g,{onClick:p,variant:"ghost",className:"w-full text-gray-500 hover:text-gray-700",children:"إعادة إرسال الرمز"})]})]}),e.jsx(S,{className:"flex flex-col space-y-2",children:e.jsx(h,{to:"/login",className:"text-sm text-gray-600 hover:text-orange-500 transition-colors",children:"العودة لتسجيل الدخول"})})]})]})})}export{F as default};
